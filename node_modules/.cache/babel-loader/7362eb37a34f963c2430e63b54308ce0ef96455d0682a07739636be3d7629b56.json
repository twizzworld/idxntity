{"ast":null,"code":"import _toConsumableArray from \"/Users/rizzytwizzy/Projects/idxntity/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _createForOfIteratorHelper from \"/Users/rizzytwizzy/Projects/idxntity/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport deepEqual from 'fast-deep-equal';\nvar globalCache = [];\nfunction handleAsset(fn, cache, args) {\n  var lifespan = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n  var preload = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n  var _iterator = _createForOfIteratorHelper(cache),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var _entry = _step.value;\n      // Find a match\n      if (deepEqual(args, _entry.args)) {\n        // If we're pre-loading and the element is present, just return\n        if (preload) return; // If an error occurred, throw\n\n        if (_entry.error) throw _entry.error; // If a response was successful, return\n\n        if (_entry.response) return _entry.response; // If the promise is still unresolved, throw\n\n        throw _entry.promise;\n      }\n    } // The request is new or has changed.\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  var entry = {\n    args: args,\n    promise:\n    // Make the promise request.\n    fn.apply(void 0, _toConsumableArray(args)) // Response can't be undefined or else the loop above wouldn't be able to return it\n    // This is for promises that do not return results (delays for instance)\n    .then(function (response) {\n      return entry.response = response != null ? response : true;\n    }).catch(function (e) {\n      return entry.error = e != null ? e : 'unknown error';\n    }).then(function () {\n      if (lifespan > 0) {\n        setTimeout(function () {\n          var index = cache.indexOf(entry);\n          if (index !== -1) cache.splice(index, 1);\n        }, lifespan);\n      }\n    })\n  };\n  cache.push(entry);\n  if (!preload) throw entry.promise;\n}\nfunction _clear(cache) {\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n  if (args === undefined || args.length === 0) cache.splice(0, cache.length);else {\n    var entry = cache.find(function (entry) {\n      return deepEqual(args, entry.args);\n    });\n    if (entry) {\n      var index = cache.indexOf(entry);\n      if (index !== -1) cache.splice(index, 1);\n    }\n  }\n}\nfunction createAsset(fn) {\n  var lifespan = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var cache = [];\n  return {\n    /**\n     * @throws Suspense Promise if asset is not yet ready\n     * @throws Error if the promise rejected for some reason\n     */\n    read: function read() {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      return handleAsset(fn, cache, args, lifespan);\n    },\n    preload: function preload() {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      return void handleAsset(fn, cache, args, lifespan, true);\n    },\n    clear: function clear() {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n      return _clear.apply(void 0, [cache].concat(args));\n    },\n    peek: function peek() {\n      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n        args[_key5] = arguments[_key5];\n      }\n      var _cache$find;\n      return (_cache$find = cache.find(function (entry) {\n        return deepEqual(args, entry.args);\n      })) == null ? void 0 : _cache$find.response;\n    }\n  };\n}\nfunction useAsset(fn) {\n  for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n    args[_key6 - 1] = arguments[_key6];\n  }\n  return handleAsset(fn, globalCache, args, useAsset.lifespan);\n}\nuseAsset.lifespan = 0;\nuseAsset.clear = function () {\n  for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n    args[_key7] = arguments[_key7];\n  }\n  return _clear.apply(void 0, [globalCache].concat(args));\n};\nuseAsset.preload = function (fn) {\n  for (var _len8 = arguments.length, args = new Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {\n    args[_key8 - 1] = arguments[_key8];\n  }\n  return void handleAsset(fn, globalCache, args, useAsset.lifespan, true);\n};\nuseAsset.peek = function () {\n  for (var _len9 = arguments.length, args = new Array(_len9), _key9 = 0; _key9 < _len9; _key9++) {\n    args[_key9] = arguments[_key9];\n  }\n  var _globalCache$find;\n  return (_globalCache$find = globalCache.find(function (entry) {\n    return deepEqual(args, entry.args);\n  })) == null ? void 0 : _globalCache$find.response;\n};\nexport { createAsset, useAsset };","map":{"version":3,"names":["deepEqual","globalCache","handleAsset","fn","cache","args","lifespan","arguments","length","undefined","preload","_iterator","_createForOfIteratorHelper","_step","s","n","done","entry","value","error","response","promise","err","e","f","apply","_toConsumableArray","then","catch","setTimeout","index","indexOf","splice","push","clear","_len","Array","_key","find","createAsset","read","_len2","_key2","_len3","_key3","_len4","_key4","concat","peek","_len5","_key5","_cache$find","useAsset","_len6","_key6","_len7","_key7","_len8","_key8","_len9","_key9","_globalCache$find"],"sources":["/Users/rizzytwizzy/Projects/idxntity/node_modules/use-asset/dist/index.js"],"sourcesContent":["import deepEqual from 'fast-deep-equal';\n\nconst globalCache = [];\n\nfunction handleAsset(fn, cache, args, lifespan = 0, preload = false) {\n  for (const entry of cache) {\n    // Find a match\n    if (deepEqual(args, entry.args)) {\n      // If we're pre-loading and the element is present, just return\n      if (preload) return; // If an error occurred, throw\n\n      if (entry.error) throw entry.error; // If a response was successful, return\n\n      if (entry.response) return entry.response; // If the promise is still unresolved, throw\n\n      throw entry.promise;\n    }\n  } // The request is new or has changed.\n\n\n  const entry = {\n    args,\n    promise: // Make the promise request.\n    fn(...args) // Response can't be undefined or else the loop above wouldn't be able to return it\n    // This is for promises that do not return results (delays for instance)\n    .then(response => entry.response = response != null ? response : true).catch(e => entry.error = e != null ? e : 'unknown error').then(() => {\n      if (lifespan > 0) {\n        setTimeout(() => {\n          const index = cache.indexOf(entry);\n          if (index !== -1) cache.splice(index, 1);\n        }, lifespan);\n      }\n    })\n  };\n  cache.push(entry);\n  if (!preload) throw entry.promise;\n}\n\nfunction clear(cache, ...args) {\n  if (args === undefined || args.length === 0) cache.splice(0, cache.length);else {\n    const entry = cache.find(entry => deepEqual(args, entry.args));\n\n    if (entry) {\n      const index = cache.indexOf(entry);\n      if (index !== -1) cache.splice(index, 1);\n    }\n  }\n}\n\nfunction createAsset(fn, lifespan = 0) {\n  const cache = [];\n  return {\n    /**\n     * @throws Suspense Promise if asset is not yet ready\n     * @throws Error if the promise rejected for some reason\n     */\n    read: (...args) => handleAsset(fn, cache, args, lifespan),\n    preload: (...args) => void handleAsset(fn, cache, args, lifespan, true),\n    clear: (...args) => clear(cache, ...args),\n    peek: (...args) => {\n      var _cache$find;\n\n      return (_cache$find = cache.find(entry => deepEqual(args, entry.args))) == null ? void 0 : _cache$find.response;\n    }\n  };\n}\n\nfunction useAsset(fn, ...args) {\n  return handleAsset(fn, globalCache, args, useAsset.lifespan);\n}\n\nuseAsset.lifespan = 0;\n\nuseAsset.clear = (...args) => clear(globalCache, ...args);\n\nuseAsset.preload = (fn, ...args) => void handleAsset(fn, globalCache, args, useAsset.lifespan, true);\n\nuseAsset.peek = (...args) => {\n  var _globalCache$find;\n\n  return (_globalCache$find = globalCache.find(entry => deepEqual(args, entry.args))) == null ? void 0 : _globalCache$find.response;\n};\n\nexport { createAsset, useAsset };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}